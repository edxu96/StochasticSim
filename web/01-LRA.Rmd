---
editor_options:
  chunk_output_type: console
---

# (PART) Statistics {-}

# Linear Regression Analysis (LRA) {#LRA}

```{r, include=F}
options(width = 80, pillar.sigfig = 5)
knitr::opts_chunk$set(
  comment = "#>",
  echo = F,
  fig.align="center"
)
rm(list = ls())
```

Following packages and functions are used in this chapter:

```{r packages, message=F, echo=T}
## basic packages
library(knitr)
library(kableExtra)
library(tidyverse)
library(conflicted)
library(magrittr)
library(broom)
## paticular packages for this project
library(lmtest)
library(corrr)
library(tseries)
library(corrplot)
library(car)
library(perturb)
source("../src/funcs.R")
source("../src/tests.R")
```

**To-Learn**

- [x] Confidence Interval
- [x] MSA
- [ ] Likelihood Ratio Test
- [ ] ANOVA
- [ ] Orthogonalization

## Summary of Data and Models

### Dataset `1980-us-census-part`

```{r}
dat_part <-
  read_csv("../data/1980-us-census-part.csv") %>%
  dplyr::select(part = Part, educ = schooling)
```

```{r}
mods_part <- list()
mods_part[[1]] <- dat_part %>%
  as.data.frame() %>%
  {glm(part ~ educ, data = ., family = "binomial")}
mods_part[[2]] <- dat_part %>%
  as.data.frame() %>%
  {glm(part ~ 1, data = ., family = "binomial")}
```

### Dataset `1980-us-census`

```{r}
dat_census <-
  read_csv("../data/1980-us-census.csv") %>%
  mutate(wage_log = LwageW) %>%
  dplyr::select(educ, wage_log)
```

```{r}
mods_census <- list()
mods_census[[1]] <- lm(wage_log ~ educ, data = dat_census)
```

###

The data set is defined as follows based on file `recs.csv`:

```{r recs, message=F, echo=T}
set.seed(6)
dat_recs <-
  read_csv("../data/recs.csv") %>%
  dplyr::slice(sample(nrow(.), 300)) %>%
  mutate(y = log(KWH / NHSLDMEM)) %>%
  mutate(x8 = TOTROOMS + NCOMBATH + NHAFBATH) %>%
  dplyr::select(y, x2 = NHSLDMEM, x3 = EDUCATION, x4 = MONEYPY, x5 = HHSEX,
    x6 = HHAGE, x7 = ATHOME, x8) %>%
  mutate_at(seq(2, 8), as.integer) %>%  # make continuous variables discrete
  mutate(x5 = - x5 + 2)
```

Models used in the context are:

```{r, echo=T}
mods_recs <- list()
mods_recs[[1]] <- lm(y ~ x2 + x3 + x4 + x5 + x6 + x7, data = dat_recs)
mods_recs[[2]] <- lm(y ~ x2 + x3 + x4 + x6 + x7, data = dat_recs)
mods_recs[[3]] <- lm(y ~ x2 + x4 + x6 + x7, data = dat_recs)
```

The dataset `delivery` is from [@montgomery2012introduction]:

```{r delivery, echo=T}
dat_delivery <- 
  readxl::read_xls("../data/delivery.xls", col_names = c("i", "time", "case",
    "dist"), skip = 1)
```

The dataset `acetylene` is from [@montgomery2012introduction]:

```{r acetylene, echo=T}
dat_acetylene <-
  readxl::read_xls("../data/acetylene.xls", col_names = c("i", "p", "t_raw",
    "h_raw", "c_raw"), skip = 1) %>%
  mutate(t = (t_raw - 1212.5) / 80.623) %>%
  mutate(h = (h_raw - 12.44) / 5.662) %>%
  mutate(c = (c_raw - 0.0403) / 0.03164) %>%
  select(i, p, t, h, c)
```

<!-- ```{r child = '../docs/LRA-visual.Rmd'} -->
<!-- ``` -->

<!-- ```{r child = '../docs/LRA-MSA.Rmd'} -->
<!-- ``` -->

<!-- ```{r child = '../docs/LRA-multi.Rmd'} -->
<!-- ``` -->

<!-- ```{r child = '../docs/LRA-model.Rmd'} -->
<!-- ``` -->

<!-- ```{r child = '../docs/LRA-factor.Rmd'} -->
<!-- ``` -->

```{r child = '../docs/LRA-infer.Rmd'}
```
