[
["LRA.html", "Chapter 1 Linear Regression Analysis (LRA)", " Chapter 1 Linear Regression Analysis (LRA) Following packages and functions are used in this chapter: ## basic packages library(knitr) library(kableExtra) library(tidyverse) library(conflicted) library(magrittr) library(broom) ## paticular packages for this project library(lmtest) library(corrr) library(tseries) library(corrplot) library(car) library(perturb) source(&quot;../src/funcs.R&quot;) source(&quot;../src/tests.R&quot;) The data set is defined as follows based on file recs.csv: set.seed(6) dat_recs &lt;- read_csv(&quot;../data/recs.csv&quot;) %&gt;% dplyr::slice(sample(nrow(.), 300)) %&gt;% mutate(y = log(KWH / NHSLDMEM)) %&gt;% mutate(x8 = TOTROOMS + NCOMBATH + NHAFBATH) %&gt;% dplyr::select(y, x2 = NHSLDMEM, x3 = EDUCATION, x4 = MONEYPY, x5 = HHSEX, x6 = HHAGE, x7 = ATHOME, x8) %&gt;% mutate_at(seq(2, 8), as.integer) %&gt;% # make continuous variables discrete mutate(x5 = - x5 + 2) Models used in the context are: mods_recs &lt;- list() mods_recs[[1]] &lt;- lm(y ~ x2 + x3 + x4 + x5 + x6 + x7, data = dat_recs) mods_recs[[2]] &lt;- lm(y ~ x2 + x3 + x4 + x6 + x7, data = dat_recs) mods_recs[[3]] &lt;- lm(y ~ x2 + x4 + x6 + x7, data = dat_recs) The dataset delivery is from (Montgomery, Peck, and Vining 2012): dat_delivery &lt;- readxl::read_xls(&quot;../data/delivery.xls&quot;, col_names = c(&quot;i&quot;, &quot;time&quot;, &quot;case&quot;, &quot;dist&quot;), skip = 1) The dataset acetylene is from (Montgomery, Peck, and Vining 2012): dat_acetylene &lt;- readxl::read_xls(&quot;../data/acetylene.xls&quot;, col_names = c(&quot;i&quot;, &quot;p&quot;, &quot;t_raw&quot;, &quot;h_raw&quot;, &quot;c_raw&quot;), skip = 1) %&gt;% mutate(t = (t_raw - 1212.5) / 80.623) %&gt;% mutate(h = (h_raw - 12.44) / 5.662) %&gt;% mutate(c = (c_raw - 0.0403) / 0.03164) %&gt;% select(i, p, t, h, c) To-Learn Confidence Interval MSA Likelihood Ratio Test ANOVA Orthogonalization Simulation Generator "],
["statistical-inference.html", "1.1 Statistical Inference", " 1.1 Statistical Inference 1.1.1 Hypothesis Tests The null hypothesis, denoted by \\(\\mathrm{H}_{0}\\), is a statement about a population parameter. The alternative hypothesis is denoted by \\(\\mathrm{H}_{1}\\). The null hypothesis will be rejected if it appears to be inconsistent with the sample data and will not be rejected otherwise. The rejection of the null hypothesis \\(\\mathrm{H}_{0}\\) is a strong statement that \\(\\mathrm{H}_{0}\\) does not appear to be consistent with the observed data. The result that \\(\\mathrm{H}_{0}\\) is not rejected is a weak statement that should be interpreted to mean that \\(\\mathrm{H}_{0}\\) is consistent with the data. (???) A test statistic is a statistic whose value is determined from the sample data. Depending on the value of this test statistic, the null hypothesis will be rejected or not. The critical region, also called the rejection region, is that set of values of the test statistic for which the null hypothesis is rejected. (???) The classical procedure for testing a null hypothesis is to fix a small level of significance \\(\\alpha\\) and then require that the probability of rejecting \\(\\mathrm{H}_{0}\\) when \\(\\mathrm{H}_{0}\\) is true is less than or equal to \\(\\alpha\\). (???) Critical values are calculated by: qchisq(1 - alpha, df, lower.tail = TRUE, log.p = FALSE) (a) Design of Hypothesis Tests If you are trying to establish a certain hypothesis, then that hypothesis should be designated as the alternative hypothesis. Similarly, if you are trying to discredit a hypothesis, that hypothesis should be designated the null hypothesis. (???) Example 1.1 Thus, for instance, if the tobacco company is running the experiment to prove that the mean nicotine level of its cigarettes is less than \\(1.5,\\) then it should choose for the null hypothesis \\[ \\mathrm{H}_{0}: \\mu \\geq 1.5 \\] and for the alternative hypothesis \\[ \\mathrm{H}_{1}: \\mu&lt;1.5 \\] Then the company could use a rejection of the null hypothesis as “proof” of its claim that the mean nicotine content was less than 1.5 milligrams. (b) Interpretation of Test Result When conducting a statistical test, the thought experiment is that our sample is drawn from some hypothetical population distribution that could have generated the data. Our sample is then compared with hypothetical samples drawn from that hypothetical population distribution. (??? Interpreting the Test Result) 1.1.2 Likelihood Ratio Test (LLR-Test) Likelihood ratio tests are well suited for making inferences about restrictions on a well-specified model, where we are able, and willing, to maximize the likelihood function in the unrestricted model as well as the restricted model. (Hendry and Nielsen 2007) From section 1-3-4, 2-3-2 in (Hendry and Nielsen 2007): \\[ \\mathrm{Q} = \\frac{\\max _{\\theta \\in \\Theta_{R}} \\mathrm{L}_{Y_{1}, \\ldots, Y_{n}}(\\theta)}{\\max _{\\theta \\in \\Theta_{U}} \\mathrm{L}_{Y_{1}, \\ldots, Y_{n}}(\\theta)} \\] \\[ \\mathrm{LR} = -2 \\log \\mathrm{Q} = 2 \\left\\{\\max _{\\theta \\in \\Theta_{U}} \\ell_{Y_{1}, \\ldots, Y_{n}}(\\theta)-\\max _{\\theta \\in \\Theta_{R}} \\ell_{Y_{1}, \\ldots, Y_{n}}(\\theta)\\right\\} \\] where the closer \\(\\mathrm{LR}\\) is to zero, the more likely it is that \\(\\theta\\) could satisfy the restriction. A statistical test can now be constructed as a decision rule. If \\(\\mathrm{Q}\\) is (close to) unity, and correspondingly \\(\\mathrm{LR}\\) is small, the restricted maximum likelihood estimate would be (nearly) as likely as the unrestricted estimate, so in that case, we would fail to reject the hypothesis. We therefore choose a critical value \\(c&gt;0,\\) and reject the hypothesis if \\(\\mathrm{LR} &gt; c\\). (a) Signed LLR-Test mod %&gt;% summary() %&gt;% {pt(coef(.)[2, 3], mod$df, lower = FALSE)} %&gt;% {. &lt;= qchisq(0.95, 1, lower.tail = TRUE, log.p = FALSE)} https://stats.stackexchange.com/questions/325354/if-and-how-to-use-one-tailed-testing-in-multiple-regression https://stackoverflow.com/questions/8089797/inference-about-slope-coefficient-in-r https://stackoverflow.com/questions/13811472/one-sided-hypothesis-test-with-t-statistic-in-r (b) LLR-Test for One Parameter Likelihood ratio tests for restricting one parameter can be performed by using partial correlations. #&gt; Registered S3 methods overwritten by &#39;lme4&#39;: #&gt; method from #&gt; cooks.distance.influence.merMod car #&gt; influence.merMod car #&gt; dfbeta.influence.merMod car #&gt; dfbetas.influence.merMod car term estimate std.error statistic p.value p.r.squared (Intercept) 8.615613 0.200829 42.9002 2.434e-128 0.8626622 x2 -0.259971 0.029144 -8.9203 5.153e-17 0.2135731 x3 -0.081468 0.037994 -2.1442 3.284e-02 0.0154493 x4 0.064473 0.019196 3.3586 8.869e-04 0.0370726 x5 -0.034200 0.072129 -0.4742 6.357e-01 0.0007667 x6 0.007251 0.002403 3.0173 2.774e-03 0.0301358 x7 0.013147 0.017798 0.7387 4.607e-01 0.0018588 mods_recs[[1]] %&gt;% tab_tidy(T) %&gt;% {.[5, 6]} %&gt;% as.numeric() %&gt;% {- 299 * log(1 - .)} %&gt;% {1 - pchisq(., 1)} #&gt; [1] 0.6320156 whi stat df1 df2 p_value prob if_reject logLik 0.2301 1 299 0.6314 0.05 FALSE The deviance is the residual sum of square: r.squared adj.r.squared sigma statistic p.value df logLik AIC BIC deviance df.residual 0.3159 0.3018 0.6122 22.54 7.957e-22 7 -274.9 565.9 595.5 109.8 293 (c) LLR-Test for More Parameters Likelihood tests for restricting more than one parameter can be only performed by using values of log likelihood in the original and restricted models. For example, to test the hypothesis that coefficients for x5 and x7 are both 0 in mods_recs[[1]], following calculation can be conducted. We cannot reject the hypothesis according the function output. whi stat df1 df2 p_value prob if_reject logLik 5.178 2 298 0.02287 0.05 TRUE The above three test statistics are related in an additive manner, so models with multiple regressors can be reduced in a step-wise procedure. During every step, partial correlations for regressors can be used as the indication of the next term to be reduced. #&gt; [1] TRUE 1.1.3 Confidence Interval By choosing a 95% coverage, we accept that with 5% confidence we reach the false conclusion that the true parameter is not in the confidence interval. (??? Confidence Intervals) #&gt; 2.5 % 97.5 % #&gt; (Intercept) 8.220362250 9.01086394 #&gt; x2 -0.317328785 -0.20261313 #&gt; x3 -0.156243666 -0.00669182 #&gt; x4 0.026693277 0.10225333 #&gt; x5 -0.176156322 0.10775608 #&gt; x6 0.002521419 0.01198065 #&gt; x7 -0.021881524 0.04817554 Simulation Generator "]
]
